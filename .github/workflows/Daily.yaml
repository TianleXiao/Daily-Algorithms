name: Variable Intensity Daily Commit

on:
  schedule:
    # æ¯å¤© UTC æ—¶é—´å‡Œæ™¨ 1 ç‚¹æ‰§è¡Œ (å¯¹åº” UTC+8 æ—©ä¸Š 9:00 AM)
    - cron: '0 1 * * *' 
  workflow_dispatch:

jobs:
  auto_commit:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        # âš ï¸ æ³¨æ„ï¼šä¸ºäº†æ”¯æŒå¤šæ¬¡æäº¤å’Œæ¨é€ï¼Œéœ€è¦è·å–æ•´ä¸ªä»“åº“çš„å†å²è®°å½•
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
          
      - name: Set up Git config
        run: |
          # æ‚¨çš„ç”¨æˆ·åå’Œé‚®ç®±å·²ä¿ç•™
          git config --global user.name "ShimotsukiHaruka"
          git config --global user.email "xiaotlinus@gmail.com"
          
      - name: Generate Random Commits (Variable Intensity)
        run: |
          # -----------------------------------------------
          # 1. éšæœºç”Ÿæˆä»Šå¤©éœ€è¦æäº¤çš„æ¬¡æ•° (ä¾‹å¦‚ï¼š1 åˆ° 10 æ¬¡)
          # 'shuf -i 1-10 -n 1' ç”Ÿæˆ 1 åˆ° 10 ä¹‹é—´çš„éšæœºæ•´æ•°
          # -----------------------------------------------
          RANDOM_COMMIT_COUNT=$(shuf -i 1-10 -n 1)
          echo "â¡ï¸ Today's commitment: ${RANDOM_COMMIT_COUNT} commits to ensure variable color depth."
          
          LOG_FILE="daily_contribution_log.txt"
          
          # -----------------------------------------------
          # 2. å¾ªç¯æ‰§è¡Œæäº¤æ“ä½œ (å®ç°å¤šæ¬¡æäº¤)
          # -----------------------------------------------
          for i in $(seq 1 $RANDOM_COMMIT_COUNT); do
            
            # --- éšæœºå˜é‡ç”Ÿæˆ (ç¡®ä¿æ¯æ¬¡æäº¤å†…å®¹éƒ½ä¸åŒ) ---
            RANDOM_ID=$(shuf -i 1000-9999 -n 1)
            
            # éšæœºæäº¤ä¿¡æ¯æ•°ç»„
            MESSAGES=(
              "Daily log update [${i}/${RANDOM_COMMIT_COUNT}]" 
              "Automated data check: Run #${i}" 
              "System routine commit: ${RANDOM_ID}" 
              "Maintenance check ${i} of ${RANDOM_COMMIT_COUNT}"
            )
            RANDOM_MSG_INDEX=$(( RANDOM % ${#MESSAGES[@]} ))
            COMMIT_MESSAGE=${MESSAGES[${RANDOM_MSG_INDEX}]}
            
            # --- æ–‡ä»¶å†…å®¹å†™å…¥ (å¿…é¡»æ”¹å˜å†…å®¹æ‰èƒ½äº§ç”Ÿæ–° Commit) ---
            echo "--- Auto Commit Log ---" > ${LOG_FILE}
            echo "Run Count: ${i}/${RANDOM_COMMIT_COUNT}" >> ${LOG_FILE}
            echo "Timestamp: $(date '+%Y-%m-%d %H:%M:%S')" >> ${LOG_FILE}
            echo "Random Check ID: ${RANDOM_ID}" >> ${LOG_FILE}
            echo "--- End of Log ---" >> ${LOG_FILE}
            
            # --- Git æ“ä½œï¼šæäº¤å¹¶ç«‹å³æ¨é€ ---
            git add ${LOG_FILE}
            git commit -m "${COMMIT_MESSAGE}"
            
            # æ¯æ¬¡æäº¤åç«‹å³æ¨é€åˆ°è¿œç¨‹ä»“åº“
            git push
            
            echo "âœ… Successfully pushed commit #${i}"
            
          done
          
          echo "ğŸ‰ All ${RANDOM_COMMIT_COUNT} commits completed for today."